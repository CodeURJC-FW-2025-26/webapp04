<!-- 
	Form Attributes:
	- role="form": Semantic role for accessibility
	- onsubmit="submitMovieForm(event)": Submits the form via AJAX.
	- action="{{action}}": Dynamic action URL provided by the server (see movieRoutes.js)
	- enctype="multipart/form-data": Required for file uploads
-->
<form
	role="form"
	action="{{action}}"
	onsubmit="submitMovieForm(event)"
	enctype="multipart/form-data"
	class="container-fluid needs-validation p-0"
	novalidate>
	<div class="row g-3">
		<div class="col-12 col-md-6 d-flex justify-content-center align-items-start">
			<div class="image-upload-container">
				<label for="moviePoster" id="uploadBox" class="upload-box upload-box-poster p-0 m-0">
					<i class="bi bi-cloud-upload-fill"></i>
					{{#movie.poster}}
					<img src="/movie/{{movie.slug}}/poster" alt="Current poster">
					{{/movie.poster}}
					<input
						type="file"
						id="moviePoster"
						name="poster"
						accept="image/jpeg,image/png,image/jpg" />
				</label>

				<div id="imagePreview" class="image-preview" style="display: none;">
					<img id="previewImg" src="" alt="Preview">
					<button type="button" id="removeImage" class="btn btn-full mt-2 align-self-start">
						<i class="bi bi-trash3-fill"></i>
					</button>
				</div>
			</div>
		</div>

		<div class="col-12 col-md-6">
			<div class="d-flex flex-column gap-2">
				<label for="movieTitle">Movie Title</label>
				<input
					class="form-control"
					name="title"
					id="movieTitle"
					type="text"
				    placeholder="Movie Title"
				    value="{{movie.title}}">
			    <div class="invalid-feedback m-0"></div>

                <label for="movieGenre">Genre *</label>
                <select class="form-control" name="genre" id="movieGenre" multiple>
                    {{#genres}}
                    {{#value}}
                    <option value="{{value}}" {{#selected}}selected{{/selected}}>{{value}}</option>
                    {{/value}}
                    {{^value}}
                    <option value="{{.}}">{{.}}</option>
                    {{/value}}
                    {{/genres}}
                </select>
                <small class="form-text text-muted m-0">* Hold Ctrl/Cmd to select multiple</small>
                <div class="invalid-feedback m-0"></div>

                <label for="movieAgeRating">Age Rating</label>
                <select class="form-control" name="ageRating" id="movieAgeRating">
                    <option value="" disabled selected>Select an age rating</option>
                    {{#ageRating}}
                    {{#value}}
                    <option value="{{value}}" {{#selected}}selected{{/selected}}>{{value}}</option>
                    {{/value}}
                    {{^value}}
                    <option value="{{.}}">{{.}}</option>
                    {{/value}}
                    {{/ageRating}}
                </select>
                <div class="invalid-feedback m-0"></div>

                <label for="movieReleaseDate">Release Date</label>
                <input
                    class="form-control"
                    name="releaseDate"
                    id="movieReleaseDate"
                    type="date"
                    value="{{movie.releaseDate}}">
                <div class="invalid-feedback m-0"></div>

                <label for="movieCountryOfProduction">Country of Production *</label>
                <select class="form-control" name="countryOfProduction" id="movieCountryOfProduction" multiple>
                    {{#countries}}
                    {{#value}}
                    <option value="{{value}}" {{#selected}}selected{{/selected}}>{{value}}</option>
                    {{/value}}
                    {{^value}}
                    <option value="{{.}}">{{.}}</option>
                    {{/value}}
                    {{/countries}}
                </select>
                <small class="form-text text-muted m-0">* Hold Ctrl/Cmd to select multiple</small>
                <div class="invalid-feedback m-0"></div>

                <label for="movieDescription">Description</label>
                <textarea
                    class="form-control"
                    name="description"
                    id="movieDescription"
                    rows="3"
                    placeholder="Enter a description (50-1000 characters)">{{#movie}}{{movie.description}}{{/movie}}</textarea>
                <small class="form-text text-muted m-0" id="charCount">0 / 1000 characters</small>
                <div class="invalid-feedback m-0"></div>

				{{>partials/actorFormSection}}

				<button type="submit" class="btn btn-full mt-2">
					{{#movie}}
					<span>Update</span>
					{{/movie}}
					{{^movie}}
					<span>Save</span>
					{{/movie}}
					<i class="bi bi-save"></i>
				</button>
                <div id="loadingSpinner" class="formSpinner mt-2" role="status" style="display: none;">
                    <div class="spinner-border" role="status"></div>
                    <span class="text-muted">Processing ...</span>
                </div>
			</div>
		</div>
	</div>
</form>